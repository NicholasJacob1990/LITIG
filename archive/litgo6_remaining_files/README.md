# üöÄ LITGO5 - Sistema de Match Jur√≠dico Inteligente

## üéØ Vis√£o Geral

O **LITGO5** √© uma plataforma inovadora que conecta clientes a advogados especializados atrav√©s de intelig√™ncia artificial. Utilizando algoritmos avan√ßados de matching e processamento de linguagem natural, oferecemos a solu√ß√£o mais eficiente para encontrar representa√ß√£o jur√≠dica qualificada.

### ‚ú® Principais Funcionalidades

- **ü§ñ Triagem Inteligente**: An√°lise autom√°tica de casos com Claude AI
- **üéØ Match Preciso**: Algoritmo propriet√°rio com 7 dimens√µes de an√°lise
- **üí° Explica√ß√µes IA**: Justificativas personalizadas para cada recomenda√ß√£o
- **‚ö° Processamento Ass√≠ncrono**: Arquitetura escal√°vel com filas Celery
- **üìä Learning-to-Rank**: Sistema de aprendizado cont√≠nuo via feedback
- **üìù Contratos Digitais**: Sistema completo com DocuSign
- **üîí Seguran√ßa Avan√ßada**: JWT, rate limiting e valida√ß√£o robusta

---

## üèóÔ∏è Arquitetura do Sistema

```mermaid
graph TB
    A[Mobile App React Native] --> B[API FastAPI]
    B --> C[Celery Worker]
    B --> D[Redis Cache/Queue]
    B --> E[PostgreSQL + pgvector]
    C --> F[Claude AI - Triagem]
    C --> G[OpenAI - Embeddings]
    B --> H[Algoritmo Match v2.1]
    B --> I[DocuSign API]
    J[LTR Pipeline] --> K[Pesos Din√¢micos]
    K --> H
    L[Audit Logs] --> J
```

### Stack Tecnol√≥gica

**Backend:**
- Python 3.10+ | FastAPI | Celery | Redis
- PostgreSQL + pgvector | Supabase
- Claude 3.5 Sonnet | OpenAI Embeddings
- DocuSign eSignature API | JWT Authentication

**Frontend:**
- React Native | Expo SDK 53+
- TypeScript | NativeWind
- Expo Router | Context API

**DevOps:**
- Docker + Docker Compose
- GitHub Actions | Render/Railway

---

## üöÄ Quick Start

### 1. Pr√©-requisitos
- Docker Desktop (obrigat√≥rio)
- Node.js 18+
- Git

### 2. Configura√ß√£o R√°pida

```bash
# Clone do reposit√≥rio
git clone <repository-url>
cd LITGO5

# Configurar ambiente
cp env.example .env
# Editar .env com suas chaves de API
```

### 3. Executar com Docker (Recomendado)

```bash
# Abrir Docker Desktop primeiro
open -a Docker

# Aguardar Docker inicializar e executar
docker-compose up -d db redis api worker

# Verificar se API est√° funcionando
curl http://localhost:8080/
# Resposta: {"status":"ok","message":"Bem-vindo √† API LITGO!"}

# Iniciar frontend
npm install
npm run dev
# Expo abrir√° em http://localhost:8081
```

### 4. Portas dos Servi√ßos
- **API FastAPI**: `http://localhost:8080`
- **Frontend Expo**: `http://localhost:8081`
- **PostgreSQL**: `localhost:54326`
- **Redis**: `localhost:6379`

---

## ü§ñ Algoritmo de Match v2.1

### Features Calculadas (7 Dimens√µes)
- **A (Area Match)**: Correspond√™ncia de √°rea jur√≠dica (0-1)
- **S (Similarity)**: Similaridade de casos via embeddings (0-1)
- **T (Taxa de √äxito)**: Taxa de sucesso hist√≥rica (0-1)
- **G (Geografia)**: Proximidade geogr√°fica (0-1)
- **Q (Qualifica√ß√£o)**: Experi√™ncia + t√≠tulos + publica√ß√µes (0-1)
- **U (Urg√™ncia)**: Capacidade de resposta r√°pida (0-1)
- **R (Reviews)**: Avalia√ß√µes dos clientes (0-1)

### Sistema de Pesos Din√¢micos (LTR)

O algoritmo utiliza **Learning-to-Rank** para otimizar automaticamente os pesos baseado no feedback real:

```python
# Pesos atuais (exemplo ap√≥s treinamento)
{
    "A": 0.40,  # √Årea jur√≠dica (mais importante)
    "S": 0.10,  # Similaridade de casos  
    "T": 0.20,  # Taxa de √™xito
    "G": 0.05,  # Geografia
    "Q": 0.15,  # Qualifica√ß√£o
    "U": 0.05,  # Urg√™ncia
    "R": 0.05   # Reviews
}
```

### Recarregamento de Pesos
```bash
# Recarrega pesos sem reiniciar a aplica√ß√£o
curl -X POST http://localhost:8080/api/internal/reload_weights
```

---

## üìä Pipeline de Learning-to-Rank

### 1. Coleta de Dados
O sistema registra automaticamente:
- Recomenda√ß√µes feitas (`AUDIT_LOGGER`)
- Feedback dos usu√°rios (aceite/recusa de ofertas)
- Resultados de contratos (ganho/perdido)

### 2. ETL e Treinamento
```bash
# ETL: Converte logs em dataset
python backend/jobs/ltr_export.py

# Treina modelo LightGBM Ranker
python backend/jobs/ltr_train.py

# Novos pesos salvos em backend/models/ltr_weights.json
```

### 3. Aplica√ß√£o Autom√°tica
- Algoritmo carrega novos pesos dinamicamente
- Melhoria cont√≠nua da qualidade das recomenda√ß√µes
- Endpoint `/internal/reload_weights` para atualiza√ß√µes

---

## üî• Funcionalidades Principais

### 1. Triagem Inteligente
```typescript
// Triagem ass√≠ncrona com Claude AI
const response = await fetch('/api/triage', {
  method: 'POST',
  headers: { 'Authorization': 'Bearer <token>' },
  body: JSON.stringify({
    texto_cliente: "Fui demitido sem justa causa...",
    coords: [-23.5505, -46.6333]
  })
});
// Retorna: { task_id: "abc123", status: "accepted" }
```

### 2. Match de Advogados
```typescript
// Buscar advogados compat√≠veis
const matches = await fetch('/api/match', {
  method: 'POST',
  body: JSON.stringify({
    case_id: "case-123",
    k: 5
  })
});
// Retorna lista rankeada com scores detalhados
```

### 3. Explica√ß√µes Personalizadas
```typescript
// Obter explica√ß√µes IA para recomenda√ß√µes
const explanations = await fetch('/api/explain', {
  method: 'POST', 
  body: JSON.stringify({
    case_id: "case-123",
    lawyer_ids: ["lw-001", "lw-002"]
  })
});
// Retorna explica√ß√µes humanizadas para cada advogado
```

---

## üìù Sistema de Contratos Digitais

### Funcionalidades de Contratos

- **‚úçÔ∏è Assinatura Digital**: Integra√ß√£o completa com DocuSign
- **üìÑ Gera√ß√£o Autom√°tica**: Templates profissionais de contratos
- **üîÑ Sincroniza√ß√£o**: Status em tempo real entre plataforma e DocuSign
- **üíº Modelos de Honor√°rios**: √äxito, fixo e por hora
- **üìä Auditoria Completa**: Rastreamento de todas as a√ß√µes

### Configura√ß√£o DocuSign

```bash
# Ativar DocuSign
USE_DOCUSIGN=true

# Configura√ß√µes DocuSign
DOCUSIGN_BASE_URL=https://demo.docusign.net
DOCUSIGN_API_KEY=your_integration_key_here
DOCUSIGN_ACCOUNT_ID=your_account_id_here
DOCUSIGN_USER_ID=your_user_id_here
DOCUSIGN_PRIVATE_KEY=your_private_key_here
```

---

## üß™ Testes e Qualidade

### Executar Testes

```bash
# Backend
cd backend
TESTING=true python -m pytest tests/ -v

# Frontend
npm run lint
npx tsc --noEmit

# Cobertura
python -m pytest tests/ --cov=backend --cov-report=html
```

### Monitoramento
- **Logs estruturados**: JSON em `logs/audit.log`
- **M√©tricas**: Prometheus em `/metrics`
- **Health Check**: GET `/`

---

## üìö Documenta√ß√£o Completa

### üìñ Documenta√ß√£o Principal
- **[ü§ñ Algoritmo de Match](./Algoritmo/Algoritmo.md)** - Documenta√ß√£o do algoritmo v2.1
- **[üìä Pipeline LTR](./Algoritmo/LTR_Pipeline.md)** - Learning-to-Rank detalhado
- **[üèóÔ∏è Arquitetura Ass√≠ncrona](./Algoritmo/Async_architecture.md)** - Fluxos e componentes
- **[üì° Documenta√ß√£o da API](./API_DOCUMENTATION.md)** - Endpoints e schemas

### üîß Corre√ß√µes e Melhorias
- **[üö® Corre√ß√µes Cr√≠ticas](./CORRECOES_CRITICAS.md)** - Problemas identificados e solu√ß√µes
- **[‚úÖ Corre√ß√µes Aplicadas](./CORRECOES_APLICADAS.md)** - Hist√≥rico de corre√ß√µes
- **[üìä Status das Corre√ß√µes](./STATUS_CORRECOES.md)** - Acompanhamento de implementa√ß√µes

### üß† IA e Algoritmos
- **[üîç Triagem com LLM](./Algoritmo/LLM-triage.md)** - Especifica√ß√£o da triagem inteligente
- **[üí° Explica√ß√µes IA](./Algoritmo/LLM-explanation.md)** - Sistema de explica√ß√µes
- **[üìä Job Jusbrasil](./Algoritmo/Jusbrasil_job.md)** - Sincroniza√ß√£o de dados oficiais

---

## üìä Status do Projeto

### ‚úÖ Implementado e Funcionando
- [x] Backend FastAPI com endpoints principais
- [x] Frontend React Native/Expo funcional
- [x] Algoritmo de match v2.1 est√°vel com LTR
- [x] Processamento ass√≠ncrono com Celery
- [x] Integra√ß√£o com Claude AI e OpenAI
- [x] PostgreSQL + pgvector + Redis
- [x] Sistema de autentica√ß√£o JWT
- [x] Docker Compose funcional
- [x] Pipeline de Learning-to-Rank
- [x] Pesos din√¢micos do algoritmo

### üîÑ Em Progresso
- [ ] Corre√ß√£o de conflitos de rotas no Expo
- [ ] Atualiza√ß√£o de depend√™ncias do Expo
- [ ] Implementa√ß√£o da API Jusbrasil real
- [ ] Cobertura completa de testes

### üéØ Pr√≥ximos Passos
- [ ] Deploy em produ√ß√£o (Render + EAS)
- [ ] Monitoramento e m√©tricas avan√ßadas
- [ ] Cache Redis inteligente
- [ ] CI/CD automatizado

---

## üîß Configura√ß√£o de Ambiente

### Vari√°veis de Ambiente Essenciais

```bash
# APIs de IA
ANTHROPIC_API_KEY=sk-ant-api03-your-key
OPENAI_API_KEY=sk-your-openai-key

# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-role-key
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# Redis (para Docker)
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0

# URLs da API
EXPO_PUBLIC_API_URL=http://localhost:8080/api
API_BASE_URL=http://localhost:8080
```

---

## üöÄ Deploy e Produ√ß√£o

### Backend (Render/Railway)

```bash
# Build Docker
docker build -t litgo-backend -f backend/Dockerfile .

# Deploy autom√°tico via GitHub
# 1. Conectar reposit√≥rio GitHub
# 2. Configurar vari√°veis de ambiente
# 3. Deploy autom√°tico
```

### Frontend (Expo EAS)

```bash
# Configurar EAS
eas login
eas build:configure

# Build para produ√ß√£o
eas build --platform all

# Submit para stores
eas submit --platform all
```

---

## ü§ù Contribuindo

### Fluxo de Desenvolvimento

1. **Fork** do reposit√≥rio
2. **Clone** sua fork: `git clone <sua-fork>`
3. **Branch** para feature: `git checkout -b feature/nova-funcionalidade`
4. **Desenvolver** seguindo os padr√µes do projeto
5. **Testar**: `npm run lint && pytest tests/`
6. **Commit**: `git commit -m "feat: adicionar nova funcionalidade"`
7. **Push**: `git push origin feature/nova-funcionalidade`
8. **Pull Request** com descri√ß√£o detalhada

### Padr√µes de Commit
```bash
feat: nova funcionalidade
fix: corre√ß√£o de bug
docs: atualiza√ß√£o de documenta√ß√£o
style: formata√ß√£o de c√≥digo
refactor: refatora√ß√£o sem mudan√ßa de funcionalidade
test: adi√ß√£o ou corre√ß√£o de testes
chore: tarefas de manuten√ß√£o
```

---

## üìû Suporte e Comunidade

### Links Importantes
- **üêõ Issues**: [GitHub Issues](https://github.com/litgo/litgo5/issues)
- **üí¨ Discuss√µes**: [GitHub Discussions](https://github.com/litgo/litgo5/discussions)
- **üìñ Wiki**: [Documenta√ß√£o T√©cnica](https://github.com/litgo/litgo5/wiki)

---

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a **MIT License** - veja o arquivo [LICENSE](./LICENSE) para detalhes.

---

## üôè Agradecimentos

- **Anthropic** - Claude AI para triagem inteligente
- **OpenAI** - Embeddings e processamento de linguagem
- **Supabase** - Backend-as-a-Service e pgvector
- **Expo** - Plataforma de desenvolvimento React Native
- **FastAPI** - Framework web moderno para Python
- **Comunidade Open Source** - Bibliotecas e ferramentas incr√≠veis

---

**üåü Se este projeto foi √∫til, considere dar uma estrela!**

---

<div align="center">

**LITGO5** - *Conectando Justi√ßa atrav√©s da Tecnologia*

[![Made with ‚ù§Ô∏è](https://img.shields.io/badge/Made%20with-‚ù§Ô∏è-red.svg)](https://github.com/litgo/litgo5)
[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://python.org)
[![React Native](https://img.shields.io/badge/React%20Native-0.79+-61DAFB.svg)](https://reactnative.dev)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-009688.svg)](https://fastapi.tiangolo.com)
[![Expo](https://img.shields.io/badge/Expo-53+-000020.svg)](https://expo.dev)

</div> 